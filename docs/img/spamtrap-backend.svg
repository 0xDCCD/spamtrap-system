<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1593px" preserveAspectRatio="none" style="width:1338px;height:1593px;" version="1.1" viewBox="0 0 1338 1593" width="1338px" zoomAndPan="magnify"><defs/><g><!--MD5=[78ed9ff9edce047cb89e8c777d48ffd8]
entity DocumentStore--><path d="M577.5,1549 C577.5,1539 643.5,1539 643.5,1539 C643.5,1539 709.5,1539 709.5,1549 L709.5,1576.2969 C709.5,1586.2969 643.5,1586.2969 643.5,1586.2969 C643.5,1586.2969 577.5,1586.2969 577.5,1576.2969 L577.5,1549 " fill="#FFFFFF" style="stroke:#000000;stroke-width:1.5;"/><path d="M577.5,1549 C577.5,1559 643.5,1559 643.5,1559 C643.5,1559 709.5,1559 709.5,1549 " fill="none" style="stroke:#000000;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="110" x="588.5" y="1576.9951">DocumentStore</text><!--MD5=[e102a179c0d8fdd5fe9257142e64acaa]
entity Honeyclient--><rect fill="#FFFFFF" height="107.1875" style="stroke:#383838;stroke-width:1.5;" width="182" x="552.5" y="1137"/><rect fill="#FFFFFF" height="10" style="stroke:#383838;stroke-width:1.5;" width="15" x="714.5" y="1142"/><rect fill="#FFFFFF" height="2" style="stroke:#383838;stroke-width:1.5;" width="4" x="712.5" y="1144"/><rect fill="#FFFFFF" height="2" style="stroke:#383838;stroke-width:1.5;" width="4" x="712.5" y="1148"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="121" x="568.5" y="1170.9951">Honeylcient Thug</text><line style="stroke:#383838;stroke-width:1.0;" x1="553.5" x2="733.5" y1="1175.2969" y2="1175.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="109" x="568.5" y="1193.292">accesses URLs,</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="140" x="568.5" y="1209.5889">detects exploits and</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="106" x="568.5" y="1225.8857">downloads files</text><!--MD5=[324b933cd50243b5e11940bfb80fa7af]
entity Sandbox--><rect fill="#FFFFFF" height="107.1875" style="stroke:#383838;stroke-width:1.5;" width="187" x="796" y="1137"/><rect fill="#FFFFFF" height="10" style="stroke:#383838;stroke-width:1.5;" width="15" x="963" y="1142"/><rect fill="#FFFFFF" height="2" style="stroke:#383838;stroke-width:1.5;" width="4" x="961" y="1144"/><rect fill="#FFFFFF" height="2" style="stroke:#383838;stroke-width:1.5;" width="4" x="961" y="1148"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="118" x="812" y="1170.9951">Cuckoo-Sandbox</text><line style="stroke:#383838;stroke-width:1.0;" x1="797" x2="982" y1="1175.2969" y2="1175.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="145" x="812" y="1193.292">performs behavioural</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="54" x="812" y="1209.5889">analysis</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="0" x="816" y="1225.8857"/><!--MD5=[e79ac7f02cf7cc6a8892186fd6215c83]
class Ingestor--><rect fill="#FFFFFF" height="61.4297" id="Ingestor" style="stroke:#383838;stroke-width:1.5;" width="137" x="336" y="7"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="57" x="376" y="25.9951">Ingestor</text><line style="stroke:#383838;stroke-width:1.5;" x1="337" x2="472" y1="35.2969" y2="35.2969"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="123" x="343" y="52.3638">subcribes to broker</text><line style="stroke:#383838;stroke-width:1.5;" x1="337" x2="472" y1="60.4297" y2="60.4297"/><!--MD5=[7bc5716ff34e8b57d97376709b158217]
class Mediator--><rect fill="#FFFFFF" height="76.5625" id="Mediator" style="stroke:#383838;stroke-width:1.5;" width="138" x="335.5" y="333"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="60" x="374.5" y="351.9951">Mediator</text><line style="stroke:#383838;stroke-width:1.5;" x1="336.5" x2="472.5" y1="361.2969" y2="361.2969"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="124" x="342.5" y="378.3638">controls processing</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="123" x="342.5" y="393.4966">distributes artifacts</text><line style="stroke:#383838;stroke-width:1.5;" x1="336.5" x2="472.5" y1="401.5625" y2="401.5625"/><!--MD5=[df152c2476dc0702efc46fc22338464c]
class Processor--><rect fill="#FFFFFF" height="61.4297" id="Processor" style="stroke:#383838;stroke-width:1.5;" width="129" x="7" y="519"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="70" x="36.5" y="537.9951">Processor</text><line style="stroke:#383838;stroke-width:1.5;" x1="8" x2="135" y1="547.2969" y2="547.2969"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="115" x="14" y="564.3638">tokenizes payload</text><line style="stroke:#383838;stroke-width:1.5;" x1="8" x2="135" y1="572.4297" y2="572.4297"/><!--MD5=[908386ed5410ce6ab2f15f3d9dcaf6ff]
class DatabaseHandler--><rect fill="#FFFFFF" height="61.4297" id="DatabaseHandler" style="stroke:#383838;stroke-width:1.5;" width="199" x="265" y="1160"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="119" x="305" y="1178.9951">DatabaseHandler</text><line style="stroke:#383838;stroke-width:1.5;" x1="266" x2="463" y1="1188.2969" y2="1188.2969"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="185" x="272" y="1205.3638">guarantees async DB access</text><line style="stroke:#383838;stroke-width:1.5;" x1="266" x2="463" y1="1213.4297" y2="1213.4297"/><!--MD5=[3ccf683964f720a4dca0e36a7af09569]
class Enricher--><rect fill="#FFFFFF" height="91.6953" id="Enricher" style="stroke:#383838;stroke-width:1.5;" width="162" x="626.5" y="859"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="57" x="679" y="877.9951">Enricher</text><line style="stroke:#383838;stroke-width:1.5;" x1="627.5" x2="787.5" y1="887.2969" y2="887.2969"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="148" x="633.5" y="904.3638">gathers additional data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="142" x="633.5" y="919.4966">by performing lookups</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="142" x="633.5" y="934.6294">and initiating analyses</text><line style="stroke:#383838;stroke-width:1.5;" x1="627.5" x2="787.5" y1="942.6953" y2="942.6953"/><!--MD5=[5a250d5920ed936d4e49446f154311f4]
class Reporter--><rect fill="#FFFFFF" height="61.4297" id="Reporter" style="stroke:#383838;stroke-width:1.5;" width="229" x="1046" y="674"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="61" x="1130" y="692.9951">Reporter</text><line style="stroke:#383838;stroke-width:1.5;" x1="1047" x2="1274" y1="702.2969" y2="702.2969"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="215" x="1053" y="719.3638">pushes results to external service</text><line style="stroke:#383838;stroke-width:1.5;" x1="1047" x2="1274" y1="727.4297" y2="727.4297"/><!--MD5=[783dc9e3eeef317a9da1c323dfb778fc]
entity Elasticsearch--><rect fill="#FFFFFF" height="38.2969" rx="35" ry="35" style="stroke:#000000;stroke-width:1.5;" width="113" x="1207" y="1025"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="91" x="1218" y="1048.9951">Elasticsearch</text><!--MD5=[cfd0a50cbfe115d01e82340911782de7]
link Ingestor to Mediator--><path codeLine="36" d="M404.5,68.1667 C404.5,86.0556 404.5,109.0556 404.5,129.5 C404.5,129.5 404.5,129.5 404.5,271.5 C404.5,289.7509 404.5,309.8754 404.5,327.2571 " fill="none" id="Ingestor-to-Mediator" style="stroke:#383838;stroke-width:1.0;"/><polygon fill="#383838" points="404.5,332.5583,408.5,323.5583,404.5,327.5583,400.5,323.5583,404.5,332.5583" style="stroke:#383838;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="110" x="406.5" y="205.0669">1. pass feed msg</text><!--MD5=[fe2c195c837aef6c2ea19cdc0010ab08]
link Mediator to Processor--><path codeLine="38" d="M335.3269,374.2296 C239.6863,379.6219 74.6174,395.3137 37.5,440 C20.0186,461.0462 31.1093,491.0573 45.1308,514.3402 " fill="none" id="Mediator-to-Processor" style="stroke:#383838;stroke-width:1.0;"/><polygon fill="#383838" points="47.7768,518.6056,46.4314,508.8491,45.141,514.3568,39.6333,513.0664,47.7768,518.6056" style="stroke:#383838;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="46" x="39.5" y="469.0669">3. pass</text><!--MD5=[b8e206229ea0ddd8bf7fc1fc229dc25b]
link Processor to Mediator--><path codeLine="43" d="M83.7973,518.7924 C95.8165,490.2312 114.1972,450.5445 127.5,440 C158.5881,415.358 259.1927,394.7385 330.1658,382.753 " fill="none" id="Processor-to-Mediator" style="stroke:#383838;stroke-width:1.0;"/><polygon fill="#383838" points="335.2233,381.9051,325.6857,379.4485,330.2921,382.732,327.0087,387.3384,335.2233,381.9051" style="stroke:#383838;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="46" x="137.5" y="454.0669">4. pass</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="62" x="129.5" y="469.1997">tokenized</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="52" x="134.5" y="484.3325">artifacts</text><!--MD5=[df1bf1d02e21470baa8655b9def76b5a]
link Mediator to DatabaseHandler--><path codeLine="39" d="M335.3497,403.542 C282.8032,433.1888 219.5,482.7553 219.5,549.5 C219.5,549.5 219.5,549.5 219.5,1044 C219.5,1093.3742 261.6186,1132.0817 300.4557,1157.2784 " fill="none" id="Mediator-to-DatabaseHandler" style="stroke:#383838;stroke-width:1.0;"/><polygon fill="#383838" points="304.6858,1159.9787,299.252,1151.7644,300.4713,1157.2883,294.9474,1158.5076,304.6858,1159.9787" style="stroke:#383838;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="74" x="221.5" y="779.0669">2. write eml</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="59" x="229" y="794.1997">to GridFS</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="73" x="222" y="809.3325">to preserve</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="46" x="235.5" y="824.4653">original</text><!--MD5=[df1bf1d02e21470baa8655b9def76b5a]
link Mediator to DatabaseHandler--><path codeLine="44" d="M380.6897,410.2228 C361.4319,445.267 337.5,498.9802 337.5,549.5 C337.5,549.5 337.5,549.5 337.5,1044 C337.5,1082.3834 346.5747,1125.5007 354.2022,1154.9622 " fill="none" id="Mediator-to-DatabaseHandler-1" style="stroke:#383838;stroke-width:1.0;"/><polygon fill="#383838" points="355.5094,1159.9347,357.0896,1150.2134,354.2381,1155.099,349.3526,1152.2475,355.5094,1159.9347" style="stroke:#383838;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="49" x="360" y="786.5669">5. store</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="62" x="351.5" y="801.6997">tokenized</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="27" x="371" y="816.8325">mail</text><!--MD5=[df1bf1d02e21470baa8655b9def76b5a]
link Mediator to DatabaseHandler--><path codeLine="45" d="M428.3103,410.2228 C447.5681,445.267 471.5,498.9802 471.5,549.5 C471.5,549.5 471.5,549.5 471.5,1044 C471.5,1089.0627 438.0775,1129.5157 408.5917,1156.436 " fill="none" id="Mediator-to-DatabaseHandler-2" style="stroke:#383838;stroke-width:1.0;"/><polygon fill="#383838" points="404.6473,1159.9793,414.0156,1156.9404,408.3668,1156.6379,408.6694,1150.9891,404.6473,1159.9793" style="stroke:#383838;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="57" x="473.5" y="786.5669">12. store</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="55" x="474.5" y="801.6997">enriched</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="52" x="476" y="816.8325">artifacts</text><!--MD5=[a54f0d2b3e91a747d83b04ba829fa208]
link Mediator to Enricher--><path codeLine="48" d="M469.3254,410.2435 C479.934,418.9309 489.9177,428.9086 497.5,440 C550.4951,517.5209 515.9646,557.4948 552.5,644 C585.2075,721.442 637.3353,803.7113 671.9823,854.7242 " fill="none" id="Mediator-to-Enricher" style="stroke:#383838;stroke-width:1.0;"/><polygon fill="#383838" points="674.8621,858.9516,673.1009,849.2615,672.0471,854.8193,666.4893,853.7655,674.8621,858.9516" style="stroke:#383838;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="111" x="554.5" y="624.0669">6. pass extracted</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="52" x="584" y="639.1997">artifacts</text><!--MD5=[616711f9422eaa4555bd61311c3d5124]
reverse link Mediator to Enricher--><path codeLine="53" d="M478.1932,402.8305 C498.1793,413.1177 519.0864,425.6522 536.5,440 C610.9619,501.352 634.2585,520.996 671.5,610 C706.1034,692.6991 710.3187,799.0319 709.4554,858.8224 " fill="none" id="Mediator-backto-Enricher" style="stroke:#383838;stroke-width:1.0;"/><polygon fill="#383838" points="473.6763,400.5352,479.8877,408.1784,478.1338,402.8003,483.5119,401.0464,473.6763,400.5352" style="stroke:#383838;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="113" x="685.5" y="624.0669">11. pass enriched</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="52" x="716" y="639.1997">artifacts</text><!--MD5=[57572eaa20e1ab74fd8dfaf0f28ab5b2]
link Enricher to Honeyclient--><path codeLine="51" d="M635.5169,951.2467 C615.9096,967.8223 597.1565,988.3509 586.5,1012 C568.977,1050.8871 584.3549,1096.7634 603.5289,1132.2694 " fill="none" id="Enricher-to-Honeyclient" style="stroke:#383838;stroke-width:1.0;"/><polygon fill="#383838" points="606.1318,1136.9875,605.2867,1127.175,603.7165,1132.6095,598.282,1131.0394,606.1318,1136.9875" style="stroke:#383838;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="46" x="601.5" y="1033.5669">7. pass</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="32" x="608.5" y="1048.6997">URLs</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="72" x="588.5" y="1063.8325">for analysis</text><!--MD5=[efac43d07e2b9281de89909f9d0d1cec]
link Honeyclient to Enricher--><path codeLine="57" d="M655.5857,1136.5867 C667.1882,1084.8286 684.5879,1007.2092 695.9928,956.3329 " fill="none" id="Honeyclient-to-Enricher" style="stroke:#383838;stroke-width:1.0;"/><polygon fill="#383838" points="697.1462,951.1878,691.2741,959.0947,696.0523,956.0667,699.0804,960.8449,697.1462,951.1878" style="stroke:#383838;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="110" x="685.5" y="1041.0669">8. return analysis</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="43" x="719" y="1056.1997">results</text><!--MD5=[74c73a44f5667a6589a7e9912a65ea09]
link Honeyclient to DocumentStore--><path codeLine="56" d="M643.5,1244.0354 C643.5,1263.4005 643.5,1285.4349 643.5,1305.5 C643.5,1305.5 643.5,1305.5 643.5,1477.5 C643.5,1496.0615 643.5,1516.9029 643.5,1533.303 " fill="none" id="Honeyclient-to-DocumentStore" style="stroke:#383838;stroke-width:1.0;"/><polygon fill="#383838" points="643.5,1538.6848,647.5,1529.6848,643.5,1533.6848,639.5,1529.6848,643.5,1538.6848" style="stroke:#383838;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="88" x="652" y="1388.5669">store analysis</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="101" x="645.5" y="1403.6997">in native format</text><!--MD5=[c6b6f2f69684867948b1eb8804a6f3fb]
link Sandbox to Enricher--><path codeLine="60" d="M950.6021,1136.8731 C984.1896,1100.733 1014.1283,1052.4566 987.5,1012 C965.313,978.2911 867.2381,946.1532 793.3705,926.0552 " fill="none" id="Sandbox-to-Enricher" style="stroke:#383838;stroke-width:1.0;"/><polygon fill="#383838" points="788.541,924.7489,796.1843,930.9601,793.3675,926.0545,798.2732,923.2377,788.541,924.7489" style="stroke:#383838;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="118" x="999.5" y="1041.0669">10. return analysis</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="43" x="1037" y="1056.1997">results</text><!--MD5=[084465e521594ffe91616a9c8b7c4f30]
link Enricher to Sandbox--><path codeLine="61" d="M755.4387,951.1452 C772.5446,969.1291 791.12,990.5548 805.5,1012 C830.6918,1049.5691 852.2475,1095.8826 867.214,1131.919 " fill="none" id="Enricher-to-Sandbox" style="stroke:#383838;stroke-width:1.0;"/><polygon fill="#383838" points="869.1898,1136.709,869.4554,1126.8637,867.2831,1132.0868,862.06,1129.9145,869.1898,1136.709" style="stroke:#383838;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="46" x="863.5" y="1026.0669">9. pass</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="86" x="843.5" y="1041.1997">attachments/</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="61" x="856" y="1056.3325">extracted</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="25" x="874" y="1071.4653">files</text><!--MD5=[fd7850e3dfc941131e54eb81263326e2]
link Sandbox to DocumentStore--><path codeLine="62" d="M856.2736,1244.1185 C847.5349,1262.8401 840.5,1284.449 840.5,1305.5 C840.5,1305.5 840.5,1305.5 840.5,1477.5 C840.5,1505.7936 771.1274,1530.4396 714.7162,1545.8037 " fill="none" id="Sandbox-to-DocumentStore" style="stroke:#383838;stroke-width:1.0;"/><polygon fill="#383838" points="709.6462,1547.1693,719.3768,1548.6908,714.4741,1545.8689,717.2961,1540.9662,709.6462,1547.1693" style="stroke:#383838;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="33" x="876.5" y="1381.0669">store</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="51" x="867.5" y="1396.1997">analysis</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="101" x="842.5" y="1411.3325">in native format</text><!--MD5=[7aae0883cb1964004315b6a0b102f0de]
link DatabaseHandler to DocumentStore--><path codeLine="66" d="M394.4726,1221.4249 C412.3117,1243.1347 431.5,1273.844 431.5,1305.5 C431.5,1305.5 431.5,1305.5 431.5,1477.5 C431.5,1508.5002 510.5818,1533.3404 572.1455,1547.9812 " fill="none" id="DatabaseHandler-to-DocumentStore" style="stroke:#383838;stroke-width:1.0;"/><polygon fill="#383838" points="577.2939,1549.1917,569.4484,1543.2379,572.4266,1548.0473,567.6173,1551.0256,577.2939,1549.1917" style="stroke:#383838;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="55" x="468" y="1388.5669">stores in</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="124" x="433.5" y="1403.6997">malspam collection</text><!--MD5=[ed9275958ee71a9f0aa7d1808529afaf]
link Mediator to Reporter--><path codeLine="68" d="M473.631,378.5376 C542.2534,387.1757 649.4837,405.183 736.5,440 C887.3476,500.3573 1044.3911,613.9495 1117.8436,670.593 " fill="none" id="Mediator-to-Reporter" style="stroke:#383838;stroke-width:1.0;"/><polygon fill="#383838" points="1122.1329,673.9094,1117.4597,665.2399,1118.1774,670.851,1112.5662,671.5687,1122.1329,673.9094" style="stroke:#383838;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="101" x="988.5" y="554.0669">13. pass results</text><!--MD5=[feea05250a4cdde11619dbca821206f6]
link Reporter to Elasticsearch--><path codeLine="70" d="M1169.8222,735.2271 C1190.1002,802.0657 1237.8633,959.4986 1256.1765,1019.8611 " fill="none" id="Reporter-to-Elasticsearch" style="stroke:#383838;stroke-width:1.0;"/><polygon fill="#383838" points="1257.6499,1024.7175,1258.8646,1014.9438,1256.1982,1019.9329,1251.2092,1017.2665,1257.6499,1024.7175" style="stroke:#383838;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="93" x="1236.5" y="909.5669">14. push to ES</text><!--MD5=[2ca70ad40077232ce213172e235749a0]
@startuml
skinparam componentStyle uml2
skinparam FontName Arial
skinparam monochrome true
skinparam classFontSize 14
skinparam classAttributeFontSize 13
skinparam componentFontSize 14
skinparam ArrowFontSize 13
skinparam shadowing false
skinparam ClassBackgroundColor white
skinparam ComponentBackgroundColor white
skinparam StorageBackgroundColor white
skinparam DatabaseBackgroundColor white
skinparam Padding 1
hide circle
allowmixing
database DocumentStore

component Honeyclient[
  Honeylcient Thug
  - - -
  accesses URLs,
  detects exploits and
  downloads files
]
component Sandbox [
Cuckoo-Sandbox
- - -
performs behavioural
analysis

]

Ingestor : subcribes to broker
Mediator : controls processing\ndistributes artifacts

Ingestor - - - - -down> Mediator : 1. pass feed msg

Mediator - -> Processor : 3. pass
Mediator - - - - - ->  DatabaseHandler :  2. write eml\nto GridFS\nto preserve\noriginal


Processor : tokenizes payload
Processor - -> Mediator :  4. pass\ntokenized\nartifacts
Mediator - - - - -> DatabaseHandler : 5. store\n   tokenized    \nmail
Mediator - - - - -> DatabaseHandler : 12. store\nenriched\nartifacts

Enricher : gathers additional data\nby performing lookups\nand initiating analyses
Mediator - -down> Enricher : 6. pass extracted\nartifacts


Enricher - - -> Honeyclient : 7. pass\nURLs\nfor analysis

Enricher - - - -up> Mediator : 11. pass enriched\nartifacts


Honeyclient - - -> DocumentStore :  store analysis\nin native format
Honeyclient - - -> Enricher : 8. return analysis\nresults


Sandbox - - -> Enricher : 10. return analysis\nresults
Enricher - - -> Sandbox : 9. pass\nattachments/\nextracted\nfiles
Sandbox - - -> DocumentStore : store\nanalysis\nin native format

Reporter : pushes results to external service
DatabaseHandler : guarantees async DB access
DatabaseHandler - - - -down-> DocumentStore : stores in\nmalspam collection

Mediator - -down-> Reporter : 13. pass results
storage Elasticsearch
Reporter - - -down> Elasticsearch : 14. push to ES
@enduml

PlantUML version 1.2020.22(Sun Dec 06 10:36:27 CET 2020)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>